{{/* 集合頁面（分類、標籤、部落格列表）的結構化資料 */}}
{{- $pageType := "CollectionPage" -}}
{{- $collectionType := "Blog" -}}

{{- if eq .Type "categories" -}}
  {{- $collectionType = "Category" -}}
{{- else if eq .Type "tags" -}}
  {{- $collectionType = "Tag" -}}
{{- else if eq .Type "authors" -}}
  {{- $collectionType = "Author" -}}
{{- end -}}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": {{ $pageType | jsonify }},
  "@id": "{{ .Permalink }}#collection",
  "url": "{{ .Permalink }}",
  "name": {{ .Title | jsonify }},
  "description": {{ .Description | default (printf "%s相關的所有文章" .Title) | jsonify }},
  "inLanguage": "zh-TW",
  "isPartOf": {
    "@type": "WebSite",
    "@id": "{{ site.BaseURL }}#website"
  },
  {{- if .Params.image -}}
  "image": {
    "@type": "ImageObject",
    "url": {{ .Params.image | absURL | jsonify }}
  },
  {{- end -}}
  "about": {
    "@type": "Thing",
    "name": {{ .Title | jsonify }},
    "description": {{ .Description | default (printf "%s相關的財務規劃知識" .Title) | jsonify }}
  },
  "mainEntity": {
    "@type": "ItemList",
    "name": {{ printf "%s文章列表" .Title | jsonify }},
    "description": {{ printf "所有關於%s的文章" .Title | jsonify }},
    "numberOfItems": {{ len .Pages }},
    "itemListElement": [
      {{- range $index, $post := .Pages -}}
        {{- if $index -}}, {{ end -}}
        {
          "@type": "ListItem",
          "position": {{ add $index 1 }},
          "item": {
            "@type": "BlogPosting",
            "@id": "{{ $post.Permalink }}#article",
            "name": {{ $post.Title | jsonify }},
            "url": "{{ $post.Permalink }}",
            "datePublished": "{{ $post.PublishDate.Format "2006-01-02T15:04:05Z07:00" }}",
            "author": {
              "@type": "Person",
              "name": {{ ($post.Params.author | default "懶大") | jsonify }}
            },
            "publisher": {
              "@type": "Organization",
              "name": {{ site.Title | jsonify }}
            }
            {{- with $post.Params.image -}},
            "image": {
              "@type": "ImageObject",
              "url": {{ . | absURL | jsonify }}
            }
            {{- end -}}
            {{- with $post.Description -}},
            "description": {{ . | jsonify }}
            {{- end -}}
          }
        }
      {{- end -}}
    ]
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "首頁",
        "item": "{{ site.BaseURL }}"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": {{ printf "%s" $collectionType | jsonify }},
        "item": {{ printf "%s%s/" $collectionType (strings.ToLower $collectionType) | relLangURL | absURL | jsonify }}
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": {{ .Title | jsonify }},
        "item": {{ .Permalink | jsonify }}
      }
    ]
  }
}
</script>