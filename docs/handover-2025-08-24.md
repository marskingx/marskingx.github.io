# AI 任務交接文件：專案儲存庫清理與發布規則強化

**日期:** 2025年8月24日
**發起人:** Mars
**執行者:** Gemini

---

## 1. 專案概述

本專案為 `lazytoberich.com.tw` 的 Hugo 原始碼儲存庫。其核心特點是擁有一套複雜且強大的本地開發與部署工作流程，其中最關鍵的是 `scripts/smart-git-manager.js` 腳本所管理的公、私儲存庫分離發布機制。

- **公有庫 (GitHub)**: 存放建置網站必要的核心原始碼。
- **私有庫 (本地)**: 存放所有開發過程中的檔案，包括 AI 記憶、IDE 設定、日誌、內部文件等。

## 2. 本次任務總結

### 主要目標
本次任務的核心目標有二：
1.  全面性地識別出公有庫中所有非網站建置必要的檔案。
2.  更新 `smart-git-manager.js` 腳本，將這些非必要檔案納入私有檔案的管轄範圍，以達成公有庫的最小化與乾淨化。

### 已完成的行動
1.  **規則更新**: `scripts/smart-git-manager.js` 中的 `privateFilePatterns` 陣列已被擴充，現在包含了一套極為詳盡的規則，涵蓋了 IDE 設定 (`.idea/`, `.vscode/`)、完整的內部文件 (`docs/`)、Python 虛擬環境 (`scripts/venv/`)、日誌檔 (`*.log`)、備份檔 (`*.zip`) 以及舊的 CI/CD 設定檔等。
2.  **大規模清理**: 透過一個複雜的、由 AI 引導的手動 Git 操作流程，已成功將絕大部分（超過 95%）先前被錯誤追蹤的私有檔案，從公有庫的追蹤清單中移除。

### 未完成的項目 (交接重點)
- 由於使用者本地端 Git 環境存在一個無法遠端解決的頑固問題（疑似 `index.lock` 相關），導致 `git rm --cached` 指令無法對某些檔案穩定生效。
- **因此，仍有少數零散的根目錄檔案殘留在公有庫的追蹤清單中**。截至本次交接，這些檔案包含：
  - `ai-shared.md`
  - `branch-analysis-report.md`
  - `hugo-simple.toml`
  - `hugo-temp.toml`
  - `theme.toml`
  - `sitemap.xml`
  - `.claude/settings.local.json`

## 3. 給下一位協作者的建議

1.  **優先處理殘留檔案**: 接手後，首要任務是將上述「未完成項目」中的檔案從 Git 追蹤中移除。**強烈建議**使用如 **SourceTree** 或 **GitHub Desktop** 等圖形化介面，在軟體中對這些檔案右鍵選擇「停止追蹤 (Stop Tracking)」，然後再提交推送。這應能繞過指令行的環境問題。

2.  **嚴格遵守已建立的發布流程**:
    - 日常的內容新增與修改，請務必使用 `npm run 上版` 指令。
    - **絕對不要**對本專案直接使用 `git add .` 後 `git commit`，這會破壞 `smart-git-manager.js` 的設計，將私有檔案錯誤地加入 commit。

3.  **理解智能提交的限制**: `smart:commit` ( `npm run 上版` 的一部分) 的設計是**覆蓋式**的，它會 `git add .` 所有工作目錄的檔案。這個設計不適用於需要精準暫存（如 `git rm --cached`）的特殊任務。若未來再有類似的清理需求，必須繞過它，採用手動 `commit` -> `smart:push` 的流程。

4.  **信任 `smart-git-manager.js` 的新規則**: 本次更新後，該腳本的規則已非常完善。未來只要是由該腳本管理的發布，新建立的非必要檔案都能被正確地歸類為私有。

---